@page "/"
@rendermode InteractiveServer

<PageTitle>Home</PageTitle>

<h1>Configure Media Upload Service</h1>

<div>
    <label>Max Concurrent Threads:</label>
    <input type="number" @bind="MaxThreads" min="1" />
</div>
<div>
    <label>Max Queue Length:</label>
    <input type="number" @bind="MaxQueue" min="1" />
</div>
<button @onclick="SubmitConfiguration">Submit</button>

@code {

    private int MaxThreads { get; set; } = 1;
    private int MaxQueue { get; set; } = 1;
    private bool configSetSuccess = false;

    private void SubmitConfiguration()
    {
        Console.WriteLine($"Submitting: MaxThreads={MaxThreads}, MaxQueue={MaxQueue}");
        configSetSuccess = mediaUploadService.Configure(MaxThreads, MaxQueue);
        if (configSetSuccess) {
            Console.WriteLine("Configuration submitted successfully.");
            NavigationManager.NavigateTo("/videos");
        } else {
            Console.WriteLine("Configuration submission failed. Perhaps the server is already configured.");
            // show a message to the user
            JSRuntime?.InvokeVoidAsync("alert", "Configuration submission failed. Perhaps the server is already configured.");
           
            
        }
    }
    [Inject]
    private IJSRuntime JSRuntime { get; set; }
    [Inject]
    private MediaUpload.MediaUploadService mediaUploadService { get; set; }
    [Inject]
    private NavigationManager NavigationManager { get; set; }
}


